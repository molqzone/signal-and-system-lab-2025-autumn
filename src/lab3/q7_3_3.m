% =============================================================================
% P55 7.3 节 编程练习 第 3 题
% 【全体同学必做】
%
% 题目：试用 MATLAB 数值计算方法求图 7-8 所示信号的傅里叶变换，
%       并画出其频谱图。
% =============================================================================

clear; clc;

% --- 第一步：定义时域参数并构造信号 ---
fs = 100;              % 采样频率 (Hz)
t = -10 : 1/fs : 10;   % 时间向量，范围足够大以包含信号
f_t = zeros(size(t));  % 初始化信号

% 构造梯形波
for i = 1:length(t)
    if abs(t(i)) <= 1
        f_t(i) = 1;                         % 平台部分
    elseif t(i) > 1 && t(i) <= 2
        f_t(i) = 2 - t(i);                  % 右侧斜坡
    elseif t(i) < -1 && t(i) >= -2
        f_t(i) = t(i) + 2;                  % 左侧斜坡
    end
end

% --- 第二步：数值计算傅里叶变换 ---
N = length(t);
F_w = fftshift(fft(f_t)) / fs; % 计算 FFT 并缩放幅度，fftshift 将 0 频率移至中间
freq = (-N/2 : N/2-1) * (fs / N); % 生成频率轴 (Hz)

% --- 第三步：绘图 ---
figure;

% 绘制时域信号
subplot(2,1,1);
plot(t, f_t, 'LineWidth', 2);
title('时域信号 f(t) (图 7-8)');
xlabel('时间 t'); ylabel('幅度');
grid on; axis([-4 4 -0.2 1.2]);

% 绘制频谱图 (幅度谱)
subplot(2,1,2);
plot(freq, abs(F_w), 'LineWidth', 2);
title('信号的频谱 (数值计算结果)');
xlabel('频率 f (Hz)'); ylabel('|F(f)|');
grid on; axis([-2 2 -0.1 3.5]); % 限制坐标轴以便观察主瓣
